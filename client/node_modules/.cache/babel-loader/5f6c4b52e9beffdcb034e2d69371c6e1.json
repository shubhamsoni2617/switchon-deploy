{"ast":null,"code":"import _objectSpread from\"/home/shubh/switchon/switchon-server/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/shubh/switchon/switchon-server/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/shubh/switchon/switchon-server/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/shubh/switchon/switchon-server/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import\"./style.css\";import makeToast from\"../../Toaster\";import{getToken,Axios}from\"../../utils\";import LoaderModal from\"../../loader-modal/LoaderModal\";var ApprovalRequest=function ApprovalRequest(_ref){var approvalRequest=_ref.approvalRequest,userId=_ref.userId,socket=_ref.socket,dispatch=_ref.dispatch;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _onClick=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(payload){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setLoading(true);_context.next=4;return Axios.patch(\"/form\",{payload:payload},{headers:{Authorization:\"Bearer \"+getToken()}});case 4:response=_context.sent;socket.emit(\"stateUpdate\",{response:{payload:payload}});setLoading(false);dispatch({type:\"UPDATE_REQUEST\",payload:payload._id});makeToast(\"success\",response.data.message);_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);if(_context.t0&&_context.t0.response&&_context.t0.response.data&&_context.t0.response.data.message){setLoading(false);makeToast(\"error\",_context.t0.response.data.message);}case 14:case\"end\":return _context.stop();}}},_callee,null,[[0,11]]);}));return function onClick(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(LoaderModal,{isLoading:loading}),approvalRequest.map(function(request){return/*#__PURE__*/React.createElement(\"div\",{className:\"user-form\",key:request._id},/*#__PURE__*/React.createElement(\"p\",null,\"A new request \",/*#__PURE__*/React.createElement(\"span\",{className:\"form-id\"},\"#\",request._id),\" has been submitted by \",request.requestor,\" to\",\" \",request.approverId===userId?\"you\":request.approverName,\" \",\"having message \\\"\",request.message,\"\\\"\"),request.approverId===userId&&/*#__PURE__*/React.createElement(\"div\",{className:\"approval-button\"},/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){var payload=_objectSpread(_objectSpread({},request),{},{state:\"approved\"});_onClick(payload);}},\"Approve\"),/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){var payload=_objectSpread(_objectSpread({},request),{},{state:\"rejected\"});_onClick(payload);}},\"Reject\")));}),!approvalRequest.length&&/*#__PURE__*/React.createElement(\"h3\",null,\"No results found\"));};export default ApprovalRequest;","map":{"version":3,"sources":["/home/shubh/switchon/switchon-server/client/src/Pages/approval-request/index.js"],"names":["React","useState","makeToast","getToken","Axios","LoaderModal","ApprovalRequest","approvalRequest","userId","socket","dispatch","loading","setLoading","onClick","payload","patch","headers","Authorization","response","emit","type","_id","data","message","map","request","requestor","approverId","approverName","state","length"],"mappings":"ooBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,MAAO,aAAP,CACA,MAAOC,CAAAA,SAAP,KAAsB,eAAtB,CACA,OAASC,QAAT,CAAmBC,KAAnB,KAAgC,aAAhC,CACA,MAAOC,CAAAA,WAAP,KAAwB,gCAAxB,CAEA,GAAMC,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,MAAmD,IAAhDC,CAAAA,eAAgD,MAAhDA,eAAgD,CAA/BC,MAA+B,MAA/BA,MAA+B,CAAvBC,MAAuB,MAAvBA,MAAuB,CAAfC,QAAe,MAAfA,QAAe,eAC3CT,QAAQ,CAAC,KAAD,CADmC,wCAClEU,OADkE,eACzDC,UADyD,eAGzE,GAAMC,CAAAA,QAAO,2FAAG,iBAAOC,OAAP,+IAEZF,UAAU,CAAC,IAAD,CAAV,CAFY,sBAIWR,CAAAA,KAAK,CAACW,KAAN,CACrB,OADqB,CAErB,CACED,OAAO,CAAPA,OADF,CAFqB,CAKrB,CACEE,OAAO,CAAE,CACPC,aAAa,CAAE,UAAYd,QAAQ,EAD5B,CADX,CALqB,CAJX,QAINe,QAJM,eAgBZT,MAAM,CAACU,IAAP,CAAY,aAAZ,CAA2B,CACzBD,QAAQ,CAAE,CAAEJ,OAAO,CAAPA,OAAF,CADe,CAA3B,EAGAF,UAAU,CAAC,KAAD,CAAV,CAEAF,QAAQ,CAAC,CACPU,IAAI,CAAE,gBADC,CAEPN,OAAO,CAAEA,OAAO,CAACO,GAFV,CAAD,CAAR,CAIAnB,SAAS,CAAC,SAAD,CAAYgB,QAAQ,CAACI,IAAT,CAAcC,OAA1B,CAAT,CAzBY,iFA2BZ,GACE,aACA,YAAIL,QADJ,EAEA,YAAIA,QAAJ,CAAaI,IAFb,EAGA,YAAIJ,QAAJ,CAAaI,IAAb,CAAkBC,OAJpB,CAKE,CACAX,UAAU,CAAC,KAAD,CAAV,CACAV,SAAS,CAAC,OAAD,CAAU,YAAIgB,QAAJ,CAAaI,IAAb,CAAkBC,OAA5B,CAAT,CACD,CAnCW,qEAAH,kBAAPV,CAAAA,OAAO,6CAAb,CAsCA,mBACE,4CACE,oBAAC,WAAD,EAAa,SAAS,CAAEF,OAAxB,EADF,CAEGJ,eAAe,CAACiB,GAAhB,CAAoB,SAACC,OAAD,qBACnB,2BAAK,SAAS,CAAC,WAAf,CAA2B,GAAG,CAAEA,OAAO,CAACJ,GAAxC,eACE,2DACgB,4BAAM,SAAS,CAAC,SAAhB,MAA4BI,OAAO,CAACJ,GAApC,CADhB,2BAEqBI,OAAO,CAACC,SAF7B,OAE2C,GAF3C,CAGGD,OAAO,CAACE,UAAR,GAAuBnB,MAAvB,CAAgC,KAAhC,CAAwCiB,OAAO,CAACG,YAHnD,CAGiE,GAHjE,qBAImBH,OAAO,CAACF,OAJ3B,MADF,CAOGE,OAAO,CAACE,UAAR,GAAuBnB,MAAvB,eACC,2BAAK,SAAS,CAAC,iBAAf,eACE,8BACE,OAAO,CAAE,kBAAM,CACb,GAAMM,CAAAA,OAAO,gCAAQW,OAAR,MAAiBI,KAAK,CAAE,UAAxB,EAAb,CACAhB,QAAO,CAACC,OAAD,CAAP,CACD,CAJH,YADF,cASE,8BACE,OAAO,CAAE,kBAAM,CACb,GAAMA,CAAAA,OAAO,gCAAQW,OAAR,MAAiBI,KAAK,CAAE,UAAxB,EAAb,CACAhB,QAAO,CAACC,OAAD,CAAP,CACD,CAJH,WATF,CARJ,CADmB,EAApB,CAFH,CAgCG,CAACP,eAAe,CAACuB,MAAjB,eAA2B,iDAhC9B,CADF,CAoCD,CA7ED,CA+EA,cAAexB,CAAAA,eAAf","sourcesContent":["import React, { useState } from \"react\";\nimport \"./style.css\";\nimport makeToast from \"../../Toaster\";\nimport { getToken, Axios } from \"../../utils\";\nimport LoaderModal from \"../../loader-modal/LoaderModal\";\n\nconst ApprovalRequest = ({ approvalRequest, userId, socket, dispatch }) => {\n  const [loading, setLoading] = useState(false);\n\n  const onClick = async (payload) => {\n    try {\n      setLoading(true);\n\n      const response = await Axios.patch(\n        \"/form\",\n        {\n          payload,\n        },\n        {\n          headers: {\n            Authorization: \"Bearer \" + getToken(),\n          },\n        }\n      );\n\n      socket.emit(\"stateUpdate\", {\n        response: { payload },\n      });\n      setLoading(false);\n\n      dispatch({\n        type: \"UPDATE_REQUEST\",\n        payload: payload._id,\n      });\n      makeToast(\"success\", response.data.message);\n    } catch (err) {\n      if (\n        err &&\n        err.response &&\n        err.response.data &&\n        err.response.data.message\n      ) {\n        setLoading(false);\n        makeToast(\"error\", err.response.data.message);\n      }\n    }\n  };\n  return (\n    <div>\n      <LoaderModal isLoading={loading} />\n      {approvalRequest.map((request) => (\n        <div className=\"user-form\" key={request._id}>\n          <p>\n            A new request <span className=\"form-id\">#{request._id}</span> has\n            been submitted by {request.requestor} to{\" \"}\n            {request.approverId === userId ? \"you\" : request.approverName}{\" \"}\n            having message \"{request.message}\"\n          </p>\n          {request.approverId === userId && (\n            <div className=\"approval-button\">\n              <button\n                onClick={() => {\n                  const payload = { ...request, state: \"approved\" };\n                  onClick(payload);\n                }}\n              >\n                Approve\n              </button>\n              <button\n                onClick={() => {\n                  const payload = { ...request, state: \"rejected\" };\n                  onClick(payload);\n                }}\n              >\n                Reject\n              </button>\n            </div>\n          )}\n        </div>\n      ))}\n      {!approvalRequest.length && <h3>No results found</h3>}\n    </div>\n  );\n};\n\nexport default ApprovalRequest;\n"]},"metadata":{},"sourceType":"module"}